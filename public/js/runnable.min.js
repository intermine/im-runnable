!function(a){var b=function(a,c,d){var e=b.resolve(a);if(!e){d=d||a,c=c||"root";var f=new Error('Failed to require "'+d+'" from "'+c+'"');throw f.path=d,f.parent=c,f.require=!0,f}var g=b.modules[e];if(!g._resolving&&!g.exports){var h={};h.exports={},h.client=h.component=!0,g._resolving=!0,g.call(this,h.exports,b.relative(e),h),delete g._resolving,g.exports=h.exports}return g.exports};b.modules={},b.aliases={},b.resolve=function(a){"/"===a.charAt(0)&&(a=a.slice(1));for(var c=[a,a+".js",a+".json",a+"/index.js",a+"/index.json"],d=0;d<c.length;d++){if(a=c[d],b.modules.hasOwnProperty(a))return a;if(b.aliases.hasOwnProperty(a))return b.aliases[a]}},b.normalize=function(a,b){var c=[];if("."!=b.charAt(0))return b;a=a.split("/"),b=b.split("/");for(var d=0;d<b.length;++d)".."==b[d]?a.pop():"."!==b[d]&&""!==b[d]&&c.push(b[d]);return a.concat(c).join("/")},b.register=function(a,c){b.modules[a]=c},b.alias=function(a,c){if(!b.modules.hasOwnProperty(a))throw new Error('Failed to alias "'+a+'", it does not exist');b.aliases[c]=a},b.relative=function(a){function c(a,b){for(var c=a.length;c--;)if(a[c]===b)return c;return-1}var d=b.normalize(a,".."),e=function(c){var d=e.resolve(c);return b(d,a,c)};return e.resolve=function(e){var f=e.charAt(0);if("/"==f)return e.slice(1);if("."==f)return b.normalize(d,e);var g=a.split("/"),h=c(g,"deps")+1;return h||(h=0),e=g.slice(0,h+1).join("/")+"/deps/"+e},e.exists=function(a){return b.modules.hasOwnProperty(e.resolve(a))},e},a.require="undefined"!=typeof a.require?a.require:b}(this),function(a){!function(){a.require.register("runnable/client/components/editor.js",function(a,b,c){var d,e,f,g,h;e=b("../models/db"),g=b("../models/job"),h=b("./tabs"),f=null,e.bind("language",function(a,b){return f.setOption("mode",b)}),d=new can.Map({line:1,ch:1}),c.exports=can.Component.extend({tag:"app-editor",template:b("../templates/editor"),scope:function(){return{cursor:d}},events:{".btn.run click":function(){var a;if(a=f.getValue())return g.submit({src:f.getValue(),lang:f.getOption("mode")}),h(1)},inserted:function(a){return f=CodeMirror(a.find(".content").get(0),{mode:e.attr("language"),theme:"github",lineNumbers:!0,viewportMargin:1/0,showCursorWhenSelecting:!0,lineWrapping:!0,value:"// Require the Request library.\nvar req = require('request');\n\n// Search against FlyMine.\nreq({\n    'uri': 'http://www.flymine.org/query/service/search',\n    // For terms associated with \"micklem\".\n    'qs': { 'q': \"micklem\" }\n}, function(err, res) {\n    if (err) throw err;\n\n    // Just log it.\n    console.log(res.body);\n});"}),f.on("cursorActivity",function(){return d.attr(_.transform(f.getCursor(),function(a,b,c){return a[c]=b+1}),!0)})}}})}),a.require.register("runnable/client/components/results.js",function(a,b,c){var d;d=b("../models/job"),c.exports=can.Component.extend({tag:"app-results",template:b("../templates/results"),scope:function(){return{job:d}},helpers:{isEmpty:function(a){var b;if(b=d.attr("out"))return b.stdout.length+b.stderr.length?a.inverse(this):a.fn(this)},format:function(a){var b;try{b=JSON.parse(a),a="<code>"+JSON.stringify(b,null,2)+"</code>"}catch(c){}return"<pre>"+a+"</pre>"}}})}),a.require.register("runnable/client/components/select.js",function(a,b,c){var d,e,f,g,h;e=b("../models/db"),g=b("../models/languages"),h=can.compute(""),h.bind("change",function(a,b){var c,d,e,f,h;if(!b.length)return function(){var a,b,d;for(d=[],a=0,b=g.length;b>a;a++)c=g[a],d.push(c.attr("show",!0));return d}();for(d=new RegExp(""+b+".*","i"),h=[],e=0,f=g.length;f>e;e++)c=g[e],h.push(c.attr("show",c.attr("label").match(d)));return h}),f=can.compute(!1),f.bind("change",function(a,b){return null!=b?h(""):void 0}),d=new can.Map({}),d.bind("key",function(a,b){return e.attr("language",b)}),g.on("change",function(a,b,c,e){var f;if(("add"===c||"set"===c)&&e)return(f=b.match(/^(\d+)\.active$/))?d.attr(g.attr(parseInt(f[1])).attr(),!0):void 0}),c.exports=can.Component.extend({tag:"app-select",template:b("../templates/select"),scope:function(){return{languages:g,current:d,query:{value:h},expanded:{value:f},select:function(a){var b,c,d,e,h,i;for(e=0,h=g.length;h>e;e++)d=g[e],d.attr("active",!1);return i=a.attr(),b=i.key,c=i.label,a.attr("active",!0),f(!1)}}},events:{".field click":function(){var a;return f(a=!f()),a?this.element.find(".search .input").focus():void 0},".search .input keyup":function(a,b){switch(b.which){case 27:return f(!1);default:return h(a.val().toLowerCase().replace(/[^a-z]*/g,""))}},inserted:function(a){return $(document).on("click",function(b){return a.is(b.target)||a.has(b.target).length?void 0:f(!1)})}},helpers:{display:function(a){return a().replace(new RegExp("("+h()+")","ig"),"<span>$1</span>")}}})}),a.require.register("runnable/client/components/tabs.js",function(a,b,c){var d,e,f;e=b("../models/job"),c.exports=d=can.compute(0),f=new can.List([{label:"Editor",icon:"code",show:!0},{label:"Results",fade:!0,icon:"terminal",show:!1},{label:"Discussion",fade:!0,icon:"comment",show:!0}]),e.on("change",function(){return f.attr(1).attr("show",!0)}),e.on("status",function(a,b){var c,d;return c=function(){switch(!1){case"running"!==b:return"spin6";case!((d=this.attr("out"))&&d.stderr.length):return"attention";default:return"terminal"}}.call(this),f.attr(1).attr("icon",c)}),can.Component.extend({tag:"app-tabs",template:b("../templates/tabs"),scope:function(){return{tabs:f,"switch":function(a){return d(_.findIndex(f,a.attr()))}}},helpers:{isActive:function(a,b){return _.isFunction(a)&&(a=a()),a===d()?b.fn(this):b.inverse(this)}}})}),a.require.register("runnable/client/index.js",function(a,b,c){var d,e,f;f=b("./modules/render"),e=b("./templates/layout"),d=["tabs","editor","results","select"],c.exports=function(a){var c,g,h,i;for(h=0,i=d.length;i>h;h++)g=d[h],b("./components/"+g);return(c=$(a.el)).html(f(e)),function(){var a,b;return a=$("#nav").outerHeight(),b=$("#sidebar"),$(document).on("scroll",function(){return b.css("top",Math.max(-a,-$(window).scrollTop()))})}()}}),a.require.register("runnable/client/models/db.js",function(a,b,c){var d,e,f,g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};f=window.localStorage,d=can.Model.extend({dbName:md5("im-runnable-"+document.location.hostname),keys:null,init:function(){var a,b,c,d,e,g;if(a=f.getItem(this.dbName),(this.keys=a&&a.split(",")||[]).length){for(e=this.keys,g=[],c=0,d=e.length;d>c;c++)b=e[c],g.push(this.attr(b,JSON.parse(f.getItem(""+this.dbName+"-"+b))));return g}}}),c.exports=e=new d({language:"javascript"}),e.bind("change",function(a,b,c,d){switch(c){case"set":return f.setItem(""+this.dbName+"-"+b,JSON.stringify(d)),g.call(this.keys,b)<0&&this.keys.push(b),f.setItem(this.dbName,this.keys.join(","))}})}),a.require.register("runnable/client/models/job.js",function(a,b,c){var d;c.exports=d=new can.Map({id:null,submit:function(a){var b=this;return $.ajax({url:"/api/v1/jobs.json",type:"post",dataType:"json",contentType:"application/json",data:JSON.stringify(a)}).then(function(a){var c;return c=a.data,b.attr("id",c.id)})},get:_.debounce(function(a){var b=this;return $.ajax({url:"/api/v1/jobs/"+this.attr("id")+".json",type:"get",dataType:"json",contentType:"application/json"}).then(function(c){var d;return d=c.data,b.attr(d,!1),_.isFunction(a)?a():void 0})},500),destroy:function(a){return $.ajax({url:"/api/v1/jobs/"+a+".json",type:"delete",dataType:"json",contentType:"application/json"})}}),d.bind("id",function(a,b,c){var e;return c&&d.destroy(c),this.removeAttr("out"),(e=function(){return d.attr("out")||b!==d.attr("id")?void 0:d.get(e)})()})}),a.require.register("runnable/client/models/languages.js",function(a,b,c){var d,e,f;e=b("./db"),d=can.Model.extend({findAll:function(){return $.ajax({url:"/api/v1/languages.json",type:"get",dataType:"json"})}},{}),c.exports=f=new d.List(d.findAll()),f.on("add",function(a,b){var c,d,f,g,h;for(c=e.attr("language"),h=[],f=0,g=b.length;g>f;f++)d=b[f],c===d.attr("key")&&d.attr("active",!0),h.push(d.attr("show",!0));return h})}),a.require.register("runnable/client/modules/render.js",function(a,b,c){c.exports=function(a,b){return null==b&&(b={}),can.view.mustache(a)(b)}}),a.require.register("runnable/client/templates/editor.js",function(a,b,c){c.exports=['<div id="editor">','    <div class="header collapse row">','        <div class="small-12 large-6 columns">','            <a class="btn main run icon rocket">Run</a>','            <a class="btn disabled">Save</a>',"        </div>",'        <div class="small-12 large-6 columns">','            <span class="icon lock right"></span>','            <span class="icon cog right"></span>','            <app-select class="right"></app-select>',"        </div>","    </div>",'    <div class="collapse row">','        <div class="small-12 columns">','            <div class="content"></div>',"        </div>","    </div>",'    <div class="collapse row">','        <div class="small-12 columns">','            <div class="footer">',"                Line: {{ cursor.line }} Col: {{ cursor.ch }}","            </div>","        </div>","    </div>","</div>"].join("\n")}),a.require.register("runnable/client/templates/layout.js",function(a,b,c){c.exports=['<div id="nav" class="row collapse">','    <div class="small-12 large-8 push-2 columns title">',"        InterMine Runnable","    </div>",'    <div class="small-12 large-2 columns">','        <a class="btn dark right">Log in</a>',"    </div>","</div>","",'<div id="sidebar">','    <a class="home icon rocket" href="/">Home</a>',"","    <ul>",'        <li><a class="icon code">New Script</a></li>','        <li><a class="icon clipboard">Browse Scripts</a></li>',"    </ul>","</div>","",'<div id="content">','    <div class="row">','        <div class="intro small-12 columns">',"            <h1>Search a mine by keyword</h1>","            <p>Developed by the Micklem lab at the University of Cambridge, InterMine","                enables the creation of biological databases accessed by sophisticated","                web query tools. Parsers are provided for integrating data from many","                common biological data sources and formats, and there is a framework","                for adding your own data.</p>","        </div>","    </div>","","    <app-tabs></app-tabs>","</div>","",'<div id="footer">','    <div class="row">','        <div class="small-12 columns">',"            <p>This is a beta version.</p>","            <ul>",'                <li><a href="#">Browse Scripts</a></li>','                <li><a href="#">API Documentation</a></li>','                <li><a href="#">Help</a></li>',"            </ul>","        </div>","    </div>","</div>"].join("\n")}),a.require.register("runnable/client/templates/results.js",function(a,b,c){c.exports=['<article id="results">',"    {{ #isEmpty }}",'    <div class="warning">',"        <h2>Your script has finished</h2>",'        <span class="icon attention"></span>',"        <p>No data were logged into the terminal.</p>","    </div>","    {{ /isEmpty }}","","    {{ #job.out }}","        {{ #if stdout.length }}",'            <div class="stdout">',"                <h2>Terminal output</h2>","            {{ #each stdout }}",'                <div class="line{{ @index }}">{{{ format . @index }}}</div>',"            {{ /each }}","            </div>","        {{ /if }}","","        {{ #if stderr.length }}",'            <div class="stderr">',"                <h2>Errors found</h2>",'                <span class="icon attention"></span>',"            {{ #each stderr }}","                <pre>{{ . }}</pre>","            {{ /each }}","            </div>","        {{ /if }}","    {{ /job.out }}","</article>"].join("\n")}),a.require.register("runnable/client/templates/select.js",function(a,b,c){c.exports=["{{ #if languages.length }}",'    <div class="select {{ #if expanded.value }}expanded{{ /if }}">','        <div class="field">','            <span class="circle" style="background:{{ current.color }}"></span>',"","            {{ current.label }}","","            {{ #if expanded.value }}",'                <div class="icon nub up-dir"></div>',"            {{ else }}",'                <div class="icon nub down-dir"></div>',"            {{ /if }}","        </div>",'        <div class="dropdown">','            <div class="search">','                <span class="icon search"></span>','                <input class="input" type="text" autocomplete="off" spellcheck="off" value="{{ query.value }}" />',"            </div>",'            <ul class="options">',"                {{ #languages }}","                    {{ #if show }}",'                    <li can-click="select" {{ #if active }}class="active"{{ /if }}>','                        <span class="circle" style="background:{{ color }}"></span>',"                        {{{ display label }}}","                    </li>","                    {{ /if }}","                {{ /languages }}","            </ul>","        </div>","    </div>","{{ /if }}"].join("\n")}),a.require.register("runnable/client/templates/tabs.js",function(a,b,c){c.exports=['<div class="row">','    <div class="small-12 columns">','        <ul class="tabs">',"            {{ #each tabs }}","            {{ #if show }}",'            <li><a can-click="switch" class="{{ #fade }}fade{{ /fade }} {{ #isActive @index }}active{{ /isActive }}">','                <span class="wrapper">','                    <span class="icon {{ icon }}"></span>',"                </span>","                {{ label }}","            </a></li>","            {{ /if }}","            {{ /each }}","        </ul>","    </div>","</div>","",'<div class="row">','    <div class="small-12 columns">','        <div class="tab-content {{ #isActive 0 }}active{{ /isActive }}">',"            <app-editor></app-editor>","        </div>",'        <div class="tab-content {{ #isActive 1 }}active{{ /isActive }}">',"            <app-results></app-results>","        </div>",'        <div class="tab-content {{ #isActive 2 }}active{{ /isActive }}">',"            <article>","                <h2>Not implemented yet</h2>","","                <p>This place could contain people's comments on public scripts.</p>","            </article>","        </div>","    </div>","</div>"].join("\n")})}();var b=a.require("runnable/client/index.js");"undefined"!=typeof define&&define.amd?define("runnable",[],function(){return b}):"undefined"!=typeof module&&module.exports?module.exports=b:a.runnable=b,a.require.alias("runnable/client/index.js","runnable/index.js")}(this);